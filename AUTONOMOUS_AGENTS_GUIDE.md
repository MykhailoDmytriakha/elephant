# Руководство по автономной мультиагентной системе Elephant 🐘🤖

## Обзор

Система Elephant теперь оснащена мощной автономной мультиагентной архитектурой, вдохновленной Claude Code. Агенты работают в собственных изолированных рабочих средах, анализируют данные, создают файлы, проводят исследования и передают управление друг другу по мере необходимости.

## 🎯 Ключевые возможности

### Автономная рабочая среда
- **Изолированные workspace** для каждой задачи
- **Персистентная память** между сессиями
- **Файловая система** с полными правами в своей песочнице
- **Автоматическая организация** файлов и директорий

### Интеллектуальная маршрутизация
- **Автоматический анализ** запросов пользователя
- **Умное направление** к подходящим специалистам
- **Динамическая передача управления** между агентами
- **Fallback механизмы** для обеспечения надежности

### Специализированные агенты
1. **Роутер агент** - анализирует запросы и направляет к специалистам
2. **Агент анализа данных** - работа с CSV, визуализация, статистика
3. **Агент разработки** - программирование, скрипты, отладка
4. **Агент исследований** - веб-поиск, сбор информации
5. **Агент планирования** - создание стратегий и планов
6. **Общий чат-агент** - базовые вопросы и поддержка

## 🚀 Как использовать

### Базовое использование

Просто отправьте запрос через обычный чат интерфейс:

```
Пользователь: "Проанализируй файл sales_data.csv и создай отчет с графиками"
```

Система автоматически:
1. 🔍 Определит, что это запрос на анализ данных
2. 🤖 Направит к агенту анализа данных
3. 📁 Создаст рабочую среду для задачи
4. 📊 Проанализирует данные и создаст визуализации
5. 📄 Сохранит результаты в организованной структуре

### Примеры запросов

#### Анализ данных
```
"Загрузи и проанализируй CSV файл, найди корреляции и создай dashboard"
"Очисти данные в файле data.xlsx и построй гистограммы для числовых столбцов"
"Проведи статистический анализ и выяви аномалии в данных"
```

#### Разработка кода
```
"Напиши Python скрипт для парсинга веб-страниц"
"Создай API для работы с базой данных"
"Отладь этот код и оптимизируй производительность"
```

#### Исследования
```
"Исследуй последние тренды в области машинного обучения"
"Найди и сравни различные подходы к решению этой проблемы"
"Собери информацию о конкурентах и их продуктах"
```

#### Планирование
```
"Создай детальный план реализации мобильного приложения"
"Разработай стратегию маркетинга для стартапа"
"Составь roadmap для миграции на облако"
```

## 🏗️ Архитектура системы

### Компоненты

```
┌─────────────────────────────────────────┐
│           Router Agent                  │
│     (Анализ и маршрутизация)           │
└─────────────┬───────────────────────────┘
              │
    ┌─────────┼─────────┐
    ▼         ▼         ▼
┌─────────┐ ┌─────────┐ ┌─────────┐
│ Data    │ │ Code    │ │Research │
│ Agent   │ │ Agent   │ │ Agent   │
└─────────┘ └─────────┘ └─────────┘
              │
    ┌─────────┼─────────┐
    ▼         ▼         ▼
┌─────────┐ ┌─────────┐ ┌─────────┐
│Planning │ │Executor │ │General  │
│ Agent   │ │ Agent   │ │Chat     │
└─────────┘ └─────────┘ └─────────┘
```

### Рабочие среды (Workspaces)

Каждая задача получает изолированную рабочую среду:

```
agent_workspaces/
├── task_123_a1b2c3d4/
│   ├── data/           # Входные данные
│   ├── output/         # Результаты работы
│   ├── temp/           # Временные файлы
│   ├── scripts/        # Созданные скрипты
│   ├── reports/        # Отчеты и документы
│   └── artifacts/      # Артефакты (графики, модели)
```

## 🛠️ Инструменты агентов

### Файловая система
- **Чтение/запись** файлов
- **Создание директорий**
- **Поиск файлов** по паттернам
- **Запуск команд** в терминале
- **Управление разрешениями**

### Анализ данных
- **Загрузка CSV/Excel** файлов
- **Статистический анализ** (pandas, numpy)
- **Создание визуализаций** (matplotlib, seaborn, plotly)
- **Обнаружение паттернов** и аномалий
- **Качество данных** и очистка

### Веб-исследования
- **Поиск в интернете** (DuckDuckGo API)
- **Загрузка веб-страниц**
- **Извлечение текста** и данных
- **Проверка доступности** ресурсов

### Когнитивные функции
- **Анализ задач** и планирование
- **Оценка рисков** и возможностей
- **Декомпозиция** сложных проблем
- **Синтез информации** из разных источников

## ⚙️ Конфигурация

Система настраивается через `multi_agent_config.py`:

### Поведение агентов
- **Автономный режим** - действует самостоятельно
- **Интерактивный режим** - спрашивает подтверждения
- **Консервативный режим** - осторожный подход
- **Агрессивный режим** - проактивные действия

### Безопасность
- **Песочница** для изоляции процессов
- **Белый список** разрешенных расширений файлов
- **Черный список** заблокированных команд
- **Ограничения ресурсов** (память, время)

### Производительность
- **Максимальное количество** одновременных агентов
- **Тайм-ауты** выполнения задач
- **Управление памятью**
- **Логирование производительности**

## 🔧 Настройка для разработки

### Установка зависимостей

```bash
cd backend
pip install -r requirements.txt
```

### Переменные окружения

```bash
# .env файл
OPENAI_API_KEY=your_openai_api_key_here
ALLOWED_BASE_DIR=/path/to/workspace
PROJECT_NAME=Elephant
```

### Запуск системы

```bash
# Backend
cd backend
python -m src.main

# Frontend
cd frontend
npm install
npm start
```

## 📊 Мониторинг и логирование

### Логи агентов
- **Взаимодействия** между агентами
- **Использование инструментов**
- **Метрики производительности**
- **Ошибки и восстановление**

### Мониторинг ресурсов
- **Использование памяти** агентами
- **Время выполнения** задач
- **Количество активных** сессий
- **Размер рабочих пространств**

## 🚦 Лучшие практики

### Для пользователей
1. **Четко формулируйте** цели и требования
2. **Предоставляйте контекст** для сложных задач
3. **Используйте конкретные** технические термины
4. **Указывайте формат** желаемого результата

### Для разработчиков
1. **Тестируйте агентов** в изолированных средах
2. **Мониторьте производительность** и ресурсы
3. **Логируйте важные** действия и решения
4. **Обновляйте конфигурации** по мере необходимости

## 🔮 Будущие возможности

### Планируемые улучшения
- **Интеграция с базами данных** для долгосрочной памяти
- **Голосовой интерфейс** для взаимодействия
- **Визуальное программирование** агентов
- **Интеграция с внешними API** и сервисами
- **Collaborative filtering** для оптимизации маршрутизации

### Расширенные агенты
- **Агент машинного обучения** для построения моделей
- **Агент DevOps** для развертывания и мониторинга
- **Агент дизайна** для создания UI/UX
- **Агент тестирования** для QA и валидации

## 💡 Примеры использования

### Пример 1: Анализ продаж

```
Пользователь: "У меня есть файл sales_2023.csv с данными о продажах. 
Нужно проанализировать тренды, найти топ продукты и создать презентацию."

Система:
🔍 Detected data analysis request (confidence: 0.85). Routing to Data Analysis Agent...

📊 Создаю рабочую среду...
📁 Загружаю файл sales_2023.csv...
🔍 Анализирую структуру данных...
📈 Создаю визуализации трендов...
🏆 Определяю топ-10 продуктов...
📄 Генерирую отчет в формате PowerPoint...

✅ Готово! Файлы сохранены в workspace/task_456/output/
```

### Пример 2: Веб-скрапинг

```
Пользователь: "Напиши скрипт для сбора цен на товары с сайта конкурента"

Система:
💻 Detected code development request (confidence: 0.78). Routing to Code Development Agent...

🔧 Создаю Python скрипт для веб-скрапинга...
🌐 Добавляю обработку ошибок и rate limiting...
💾 Сохраняю данные в CSV формат...
📋 Создаю документацию по использованию...
🧪 Добавляю тесты для проверки работы...

✅ Скрипт готов! Проверьте workspace/task_789/scripts/
```

## 🆘 Поддержка и устранение неполадок

### Часто встречающиеся проблемы

1. **Агент не может получить доступ к файлу**
   - Проверьте разрешения файлов
   - Убедитесь, что файл в разрешенной директории

2. **Превышен лимит времени выполнения**
   - Увеличьте timeout_seconds в конфигурации
   - Разбейте задачу на более мелкие части

3. **Ошибка маршрутизации**
   - Проверьте логи router_agent
   - Убедитесь, что все агенты доступны

### Контакты
- **Issues**: GitHub Issues
- **Документация**: `/docs/`
- **Логи**: `backend/logs/`

---

🎉 **Добро пожаловать в будущее автономных AI агентов!** 🚀 